{"version":3,"file":"js/638.582e36f4.js","mappings":"kMAKO,MAAMA,GAAeC,EAAAA,EAAAA,IAAY,YAAa,KACnD,MAAMC,GAAQC,EAAAA,EAAAA,IAAI,IACZC,GAAWD,EAAAA,EAAAA,IAAI,IACfE,GAAUF,EAAAA,EAAAA,KAAI,GACdG,EAAQA,CAACC,EAAOC,IACbC,EAAAA,EAAMC,KAAK,wCAA4C,CAC5DC,KAAM,CAAEJ,QAAOC,cAEdI,KAAKC,KACJC,EAAAA,EAAAA,GAAU,UAAW,QACrBZ,EAAMa,MAAQF,EAAIG,QAAQC,cAC1Bb,EAASW,MAAQF,EAAIK,KAAKd,SAC1BC,EAAQU,OAAQ,EAChBI,aAAaC,QAAQ,QAASlB,EAAMa,OACpCI,aAAaC,QAAQ,WAAYhB,EAASW,OAC1CN,EAAAA,EAAMY,SAASL,QAAQM,OAAOC,cAAgBrB,EAAMa,OAC7C,IAERS,MAAM,KACE,GAGPC,EAASA,KACbvB,EAAMa,MAAQ,GACdX,EAASW,MAAQ,GACjBV,EAAQU,OAAQ,EAChBI,aAAaO,WAAW,SACxBP,aAAaO,WAAW,mBACjBjB,EAAAA,EAAMY,SAASL,QAAQM,OAAOC,eAEjCI,EAAaA,KACjB,MAAMC,EAAaT,aAAaU,QAAQ,SAClCC,EAAgBX,aAAaU,QAAQ,YACvCD,GAAcE,IAChB5B,EAAMa,MAAQa,EACdxB,EAASW,MAAQe,EACjBzB,EAAQU,OAAQ,EAChBN,EAAAA,EAAMY,SAASL,QAAQM,OAAOC,cAAgBK,IAGlD,MAAO,CACL1B,QACAE,WACAC,UACAC,QACAmB,SACAE,e,wPCxBJ,MAAMpB,GAAQJ,EAAAA,EAAAA,IAAI,IACZK,GAAWL,EAAAA,EAAAA,IAAI,IAEf4B,GAAY/B,EAAAA,EAAAA,KAEZgC,GAASC,EAAAA,EAAAA,MAETC,EAAcC,UACb5B,EAAMQ,MAAMqB,QAAW5B,EAASO,MAAMqB,SACzCtB,EAAAA,EAAAA,GAAU,QAAS,iBAErBiB,EAAUzB,MAAMC,EAAMQ,MAAOP,EAASO,OACnCH,KAAKyB,IACAA,EACFL,EAAOM,KAAK,UAEZxB,EAAAA,EAAAA,GAAU,QAAS,kB,gGAzCvByB,EAAAA,EAAAA,IAAmF,MAA/EC,MAAM,yDAAwD,gBAAY,KAC9ED,EAAAA,EAAAA,IAeO,QAfAE,UAAMC,EAAAA,EAAAA,IAAUR,EAAW,c,EAC9BK,EAAAA,EAAAA,IAGM,MAHNI,EAGM,C,aAFFJ,EAAAA,EAAAA,IAAoD,SAA7CK,IAAI,SAASJ,MAAM,cAAa,SAAK,K,SAC5CD,EAAAA,EAAAA,IAA4G,SAArGM,KAAK,QAAQC,GAAG,SAASN,MAAM,sBAAsBO,YAAY,WAAWC,SAAA,G,qCAAkBzC,EAAKQ,MAAAkC,I,iBAAL1C,EAAAQ,YAEzGwB,EAAAA,EAAAA,IAGM,MAHNW,EAGM,C,aAFFX,EAAAA,EAAAA,IAAgD,SAAzCK,IAAI,QAAQJ,MAAM,cAAa,MAAE,K,SACxCD,EAAAA,EAAAA,IAA6G,SAAtGM,KAAK,WAAWC,GAAG,QAAQN,MAAM,qBAAqBO,YAAY,QAAQC,SAAA,G,qCAAkBxC,EAAQO,MAAAkC,I,iBAARzC,EAAAO,W,aAEvGwB,EAAAA,EAAAA,IAEM,OAFDC,MAAM,eAAa,EACpBD,EAAAA,EAAAA,IAAiG,UAAzFM,KAAK,SAASL,MAAM,uBAAuBM,GAAG,UAAUK,MAAA,iBAAsB,Q,KAE1FZ,EAAAA,EAAAA,IAEM,MAFNa,EAEM,EADFC,EAAAA,EAAAA,IAA0EC,EAAA,CAA7DC,GAAG,YAAYf,MAAM,MAAMM,GAAG,c,kBAAa,IAAIU,EAAA,KAAAA,EAAA,K,QAAJ,W,4BCbpE,MAAMC,EAAc,EAEpB,O","sources":["webpack://api_todolist/./src/stores/UserStore.js","webpack://api_todolist/./src/components/Login.vue","webpack://api_todolist/./src/components/Login.vue?38a9"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { ref } from 'vue'\r\nimport axios from 'axios'\r\nimport { showToast } from '@/methods/Toast'\r\n\r\nexport const useUserStore = defineStore('userStore', () => {\r\n  const token = ref('')\r\n  const nickname = ref('')\r\n  const isLogin = ref(false)\r\n  const login = (email, password) => {\r\n    return axios.post(`${process.env.VUE_APP_API}/users/sign_in`, {\r\n      user: { email, password }\r\n    })\r\n      .then(res => {\r\n        showToast('success', '登入成功')\r\n        token.value = res.headers.authorization\r\n        nickname.value = res.data.nickname\r\n        isLogin.value = true\r\n        localStorage.setItem('token', token.value)\r\n        localStorage.setItem('nickname', nickname.value)\r\n        axios.defaults.headers.common.Authorization = token.value\r\n        return true\r\n      })\r\n      .catch(() => {\r\n        return false\r\n      })\r\n  }\r\n  const logout = () => {\r\n    token.value = ''\r\n    nickname.value = ''\r\n    isLogin.value = false\r\n    localStorage.removeItem('token')\r\n    localStorage.removeItem('nickname')\r\n    delete axios.defaults.headers.common.Authorization\r\n  }\r\n  const checkLogin = () => {\r\n    const savedToken = localStorage.getItem('token')\r\n    const savedNickname = localStorage.getItem('nickname')\r\n    if (savedToken && savedNickname) {\r\n      token.value = savedToken\r\n      nickname.value = savedNickname\r\n      isLogin.value = true\r\n      axios.defaults.headers.common.Authorization = savedToken\r\n    }\r\n  }\r\n  return {\r\n    token,\r\n    nickname,\r\n    isLogin,\r\n    login,\r\n    logout,\r\n    checkLogin\r\n  }\r\n})\r\n","<!-- eslint-disable vue/multi-word-component-names -->\r\n<template>\r\n    <h3 class=\"text-secondary fw-bold mb-3 text-center text-md-start\">最實用的線上代辦事項服務</h3>\r\n    <form @submit.prevent=\"handleLogin\">\r\n        <div class=\"col-12 mb-3\">\r\n            <label for=\"mail01\" class=\"form-label\">Email</label>\r\n            <input type=\"email\" id=\"mail01\" class=\"form-control mail01\" placeholder=\"請輸入Email\" required v-model=\"email\">\r\n        </div>\r\n        <div class=\"col-12 mb-4\">\r\n            <label for=\"pwd01\" class=\"form-label\">密碼</label>\r\n            <input type=\"password\" id=\"pwd01\" class=\"form-control pwd01\" placeholder=\"請輸入密碼\" required v-model=\"password\">\r\n        </div>\r\n        <div class=\"text-center\">\r\n            <button type=\"submit\" class=\"btn btn-secondary h5\" id=\"login01\" style=\"width: 128px;\">登入</button>\r\n        </div>\r\n        <div class=\"text-center\">\r\n            <router-link to=\"/register\" class=\"btn\" id=\"register01\">註冊帳號</router-link>\r\n        </div>\r\n    </form>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { useUserStore } from '@/stores/UserStore.js'\r\nimport { showToast } from '@/methods/Toast'\r\n// 輸入欄位綁定\r\nconst email = ref('')\r\nconst password = ref('')\r\n// 使用 Pinia 的 userStore\r\nconst userStore = useUserStore()\r\n// Vue Router 用於登入成功後導頁\r\nconst router = useRouter()\r\n// 處理登入流程\r\nconst handleLogin = async () => {\r\n  if (!email.value.trim() || !password.value.trim()) {\r\n    showToast('error', 'Email 和密碼不得為空')\r\n  }\r\n  userStore.login(email.value, password.value)\r\n    .then(success => {\r\n      if (success) {\r\n        router.push('/todo') // ✅ 成功才導向\r\n      } else {\r\n        showToast('error', '請確認帳號密碼是否正確')\r\n      }\r\n    })\r\n}\r\n</script>\r\n","import script from \"./Login.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Login.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useUserStore","defineStore","token","ref","nickname","isLogin","login","email","password","axios","post","user","then","res","showToast","value","headers","authorization","data","localStorage","setItem","defaults","common","Authorization","catch","logout","removeItem","checkLogin","savedToken","getItem","savedNickname","userStore","router","useRouter","handleLogin","async","trim","success","push","_createElementVNode","class","onSubmit","_withModifiers","_hoisted_1","for","type","id","placeholder","required","$event","_hoisted_2","style","_hoisted_3","_createVNode","_component_router_link","to","_cache","__exports__"],"sourceRoot":""}