{"version":3,"file":"js/919.450388ee.js","mappings":"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","sources":["webpack://api_todolist/./src/stores/UserStore.js","webpack://api_todolist/./src/stores/todoStore.js","webpack://api_todolist/./src/views/Todolist.vue","webpack://api_todolist/./src/views/Todolist.vue?1847"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { ref } from 'vue'\r\nimport axios from 'axios'\r\nimport { showToast } from '@/methods/Toast'\r\n\r\nexport const useUserStore = defineStore('userStore', () => {\r\n  const token = ref('')\r\n  const nickname = ref('')\r\n  const isLogin = ref(false)\r\n  const login = (email, password) => {\r\n    return axios.post(`${process.env.VUE_APP_API}/users/sign_in`, {\r\n      user: { email, password }\r\n    })\r\n      .then(res => {\r\n        showToast('success', '登入成功')\r\n        token.value = res.headers.authorization\r\n        nickname.value = res.data.nickname\r\n        isLogin.value = true\r\n        localStorage.setItem('token', token.value)\r\n        localStorage.setItem('nickname', nickname.value)\r\n        axios.defaults.headers.common.Authorization = token.value\r\n        return true\r\n      })\r\n      .catch(() => {\r\n        return false\r\n      })\r\n  }\r\n  const logout = () => {\r\n    token.value = ''\r\n    nickname.value = ''\r\n    isLogin.value = false\r\n    localStorage.removeItem('token')\r\n    localStorage.removeItem('nickname')\r\n    delete axios.defaults.headers.common.Authorization\r\n  }\r\n  const checkLogin = () => {\r\n    const savedToken = localStorage.getItem('token')\r\n    const savedNickname = localStorage.getItem('nickname')\r\n    if (savedToken && savedNickname) {\r\n      token.value = savedToken\r\n      nickname.value = savedNickname\r\n      isLogin.value = true\r\n      axios.defaults.headers.common.Authorization = savedToken\r\n    }\r\n  }\r\n  return {\r\n    token,\r\n    nickname,\r\n    isLogin,\r\n    login,\r\n    logout,\r\n    checkLogin\r\n  }\r\n})\r\n","import { defineStore } from 'pinia'\r\nimport { ref, computed } from 'vue'\r\nimport axios from 'axios'\r\nimport { showToast } from '@/methods/Toast'\r\n\r\nexport const useTodoStore = defineStore('todoStore', () => {\r\n  const todos = ref([])\r\n  const currentFilter = ref('all')\r\n  const filteredTodos = computed(() => {\r\n    if (currentFilter.value === 'finish') return todos.value.filter(t => t.checked)\r\n    if (currentFilter.value === 'unfinish') return todos.value.filter(t => !t.checked)\r\n    return todos.value\r\n  })\r\n  const unfinishCount = computed(() => todos.value.filter(t => !t.checked).length)\r\n  // 取得全部資料\r\n  const getTodos = () => {\r\n    return axios.get(`${process.env.VUE_APP_API}/todos`)\r\n      .then(res => {\r\n        todos.value = res.data.todos.map(item => ({\r\n          id: item.id,\r\n          content: item.content,\r\n          checked: !!item.completed_at\r\n        }))\r\n      })\r\n      .catch(err => console.log(err))\r\n  }\r\n  // 新增資料\r\n  const addTodo = (todo) => {\r\n    if (!todo.trim()) return\r\n    axios.post(`${process.env.VUE_APP_API}/todos`, {\r\n      todo: {\r\n        content: todo\r\n      }\r\n    })\r\n      .then(res => {\r\n        showToast('success', '新增資料成功')\r\n        getTodos()\r\n      })\r\n      .catch(err => console.log(err))\r\n  }\r\n  // 編輯資料\r\n  const editTodo = (todo) => {\r\n    return axios.put(`${process.env.VUE_APP_API}/todos/${todo.id}`, {\r\n      todo: {\r\n        content: todo.content\r\n      }\r\n    })\r\n      .then(res => {\r\n        showToast('success', '編輯資料成功')\r\n        getTodos()\r\n      })\r\n      .catch(err => console.log(err))\r\n  }\r\n  // 刪除資料\r\n  const delTodo = (todo) => {\r\n    return axios.delete(`${process.env.VUE_APP_API}/todos/${todo.id}`)\r\n      .then(res => {\r\n        showToast('success', '刪除資料成功')\r\n        getTodos()\r\n      })\r\n      .catch(err => console.log(err))\r\n  }\r\n  // 更新資料狀態\r\n  const toggleTodo = (todoid) => {\r\n    return axios.patch(`${process.env.VUE_APP_API}/todos/${todoid}/toggle`)\r\n      .then(res => {\r\n        getTodos()\r\n      })\r\n  }\r\n  const clearCompleted = () => {\r\n    const completed = todos.value.filter(item => item.checked)\r\n    let count = 0\r\n    completed.forEach(item => {\r\n      axios.delete(`${process.env.VUE_APP_API}/todos/${item.id}`)\r\n        .then(() => {\r\n          count++\r\n          if (count === completed.length) getTodos()\r\n        })\r\n    })\r\n    showToast('success', '已刪除所有完成項目')\r\n  }\r\n\r\n  return {\r\n    todos,\r\n    currentFilter,\r\n    filteredTodos,\r\n    unfinishCount,\r\n    getTodos,\r\n    addTodo,\r\n    editTodo,\r\n    toggleTodo,\r\n    delTodo,\r\n    clearCompleted\r\n  }\r\n})\r\n","<!-- eslint-disable vue/multi-word-component-names -->\r\n<template>\r\n  <div class=\"todolist_page bg-primary p-3\">\r\n    <div class=\"d-flex flex-row\">\r\n      <img src=\"../assets/img/logo.png\" alt=\"logo\" class=\"img-fluid\">\r\n      <div class=\"ms-auto\">\r\n        <span class=\"d-none d-md-inline\">{{ nickname }} 的代辦</span>\r\n        <a href=\"#\" class=\"btn ms-2\" @click=\"handleLogout\">登出</a>\r\n      </div>\r\n    </div>\r\n    <div class=\"container todolist\">\r\n      <div class=\"card input flex-row justify-content-between\">\r\n        <input type=\"text\" class=\"input_text\" placeholder=\"新增待辦事項\" v-model=\"input\" @keydown.enter=\"add\" />\r\n        <a href=\"#\" class=\"btn_add\" @click.prevent=\"add\">+</a>\r\n      </div>\r\n      <div class=\"card card_list\">\r\n        <ul class=\"tab\">\r\n          <li :class=\"{ active: todoStore.currentFilter === 'all' }\" @click=\"todoStore.currentFilter = 'all'\">全部</li>\r\n          <li :class=\"{ active: todoStore.currentFilter === 'unfinish' }\" @click=\"todoStore.currentFilter = 'unfinish'\">\r\n            待完成\r\n          </li>\r\n          <li :class=\"{ active: todoStore.currentFilter === 'finish' }\" @click=\"todoStore.currentFilter = 'finish'\">\r\n            已完成\r\n          </li>\r\n        </ul>\r\n        <div class=\"cart_content\">\r\n          <ul class=\"list\">\r\n            <li v-for=\"item in todoStore.filteredTodos\" :key=\"item.id\">\r\n              <label class=\"checkbox\">\r\n                <input type=\"checkbox\" class=\"checkedMark\" v-model=\"item.checked\"\r\n                  @change=\"todoStore.toggleTodo(item.id)\" />\r\n                <span>{{ item.content }}</span>\r\n              </label>\r\n              <div class=\"actions\">\r\n                <a href=\"#\" class=\"edit\" @click.prevent=\"editHandler(item)\">✎</a>\r\n                <a href=\"#\" class=\"delete\" @click.prevent=\"todoStore.delTodo(item)\">🗑</a>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n          <div class=\"list_footer\">\r\n            <p>{{ todoStore.unfinishCount }} 個待完成項目</p>\r\n            <a href=\"#\" @click.prevent=\"todoStore.clearCompleted\">清除已完成項目</a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { useTodoStore } from '@/stores/todoStore'\r\nimport { useUserStore } from '@/stores/UserStore'\r\nimport { useRouter } from 'vue-router'\r\nimport Swal from 'sweetalert2'\r\nconst router = useRouter()\r\nconst todoStore = useTodoStore()\r\nconst userStore = useUserStore()\r\nconst input = ref('')\r\nconst nickname = ref(localStorage.getItem('nickname') || '')\r\n\r\nonMounted(() => {\r\n  todoStore.getTodos()\r\n})\r\nconst add = () => {\r\n  todoStore.addTodo(input.value)\r\n  input.value = ''\r\n}\r\nconst editHandler = async (item) => {\r\n  const { value: newContent } = await Swal.fire({\r\n    title: '請輸入新的代辦內容',\r\n    input: 'text',\r\n    inputValue: item.content,\r\n    showCancelButton: true,\r\n    confirmButtonText: '確定修改',\r\n    cancelButtonText: '取消',\r\n    inputValidator: (value) => {\r\n      if (!value.trim()) {\r\n        return '內容不得為空值'\r\n      }\r\n      if (value.trim() === item.content.trim()) {\r\n        return '內容未修改'\r\n      }\r\n      return null\r\n    }\r\n  })\r\n  if (newContent && newContent.trim() !== item.content.trim()) {\r\n    const newItem = {\r\n      ...item,\r\n      content: newContent.trim()\r\n    }\r\n    todoStore.editTodo(newItem)\r\n  }\r\n}\r\nconst handleLogout = () => {\r\n  userStore.logout()\r\n  router.push('/login')\r\n}\r\n</script>\r\n","import script from \"./Todolist.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Todolist.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useUserStore","defineStore","token","ref","nickname","isLogin","login","email","password","axios","post","user","then","res","showToast","value","headers","authorization","data","localStorage","setItem","defaults","common","Authorization","catch","logout","removeItem","checkLogin","savedToken","getItem","savedNickname","useTodoStore","todos","currentFilter","filteredTodos","computed","filter","t","checked","unfinishCount","length","getTodos","get","map","item","id","content","completed_at","err","console","log","addTodo","todo","trim","editTodo","put","delTodo","delete","toggleTodo","todoid","patch","clearCompleted","completed","count","forEach","router","useRouter","todoStore","userStore","input","onMounted","add","editHandler","async","newContent","Swal","title","inputValue","showCancelButton","confirmButtonText","cancelButtonText","inputValidator","newItem","handleLogout","push","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","src","_imports_0","alt","class","_hoisted_3","_hoisted_4","_toDisplayString","href","onClick","_hoisted_5","_hoisted_6","type","placeholder","$event","onKeydown","_withKeys","_withModifiers","_hoisted_7","_hoisted_8","_normalizeClass","active","_unref","_cache","_hoisted_9","_hoisted_10","_Fragment","_renderList","key","_hoisted_11","onChange","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","args","__exports__"],"sourceRoot":""}